(function(){"use strict";CustomFunctions.associate("ADD",(function(e,t){return e+t})),CustomFunctions.associate("LOG",(function(e){return console.log(e),e})),CustomFunctions.associate("TESTREPEATINGPARAMETER",(async function(e,t){let r="";const o=new Excel.RequestContext;let i=o.workbook.worksheets.getActiveWorksheet();for(let a=0;a<e.length;a++){const l=e[a];if(0===l&&null!=t.parameterAddresses[a]){let e=i.getRange(t.parameterAddresses[a]).load("text");await o.sync(),""==e.text[0][0]?r+="[]":r+=e.text[0][0]}else r+=l}return r})),CustomFunctions.associate("RETURNAFTERASYNCLATENCY",(function(e,t){let r=1e3*(2*Math.random()-1)+e;return new Promise((e=>{setTimeout((()=>{e(Math.floor(r))}),r)}))})),CustomFunctions.associate("RETURNAFTERSLEEP",(function(e,t){let r=(new Date).getTime(),o=null;do{o=(new Date).getTime()}while(o-r<e);return e})),CustomFunctions.associate("GETSIMPLEENTITY",(function(){console.log("Start getSimpleEntity");let e=Math.floor(100*Math.random());return{type:Excel.CellValueType.entity,text:"Sample Entity "+e,properties:{randomNumber:{type:Excel.CellValueType.double,basicValue:e}}}})),CustomFunctions.associate("GETRICHERROR",(function(e){console.log("Start getRichError");let t=Excel.ErrorCellValueType.value,r=null;switch(e){case"timeout":t=Excel.ErrorCellValueType.timeout,r=Excel.TimeoutErrorCellValueSubType.pythonTimeoutLimitReached;break;case"blocked":t=Excel.ErrorCellValueType.blocked,r=Excel.BlockedErrorCellValueSubType.dataTypeUnsupportedApp;break;case"busy":t=Excel.ErrorCellValueType.busy,r=Excel.BusyErrorCellValueSubType.loadingImage;break;case"calc":t=Excel.ErrorCellValueType.calc,r=Excel.CalcErrorCellValueSubType.tooDeeplyNested;break;case"div0":t=Excel.ErrorCellValueType.div0;break;case"external":t=Excel.ErrorCellValueType.external,r=Excel.ExternalErrorCellValueSubType.unknown;break;default:t=Excel.ErrorCellValueType.value,r=Excel.ValueErrorCellValueSubType.coerceStringToNumberInvalid}let o={};return o=r?{type:Excel.CellValueType.error,basicType:Excel.RangeValueType.error,errorType:t,errorSubType:r}:{type:Excel.CellValueType.error,basicType:Excel.RangeValueType.error,errorType:t},o}))})(),function(){const e="products",t=268436224,r="en-US";CustomFunctions.associate("GETPRODUCTBYID",(async function(o){return console.log(`Start getProductById: Fetching product with id ${o} ...`),{type:"LinkedEntity",text:"Chai",id:{entityId:o,domainId:e,serviceId:t,culture:r}}})),CustomFunctions.associate("PRODUCTLINKEDENTITYSERVICE",(async function(o){console.log(`Start productLinkedEntityService: Fetching linked entity with id ${o} ...`);const i=new CustomFunctions.Error(CustomFunctions.ErrorCode.notAvailable);console.log(`Fetching linked entity with id ${o} ...`);try{return function(o){const i={type:"LinkedEntity",text:"Chai",id:{entityId:o,domainId:e,serviceId:t,culture:r},properties:{"Product ID":{type:"String",basicValue:o.toString()},"Product Name":{type:"String",basicValue:"Chai"},"Quantity Per Unit":{type:"String",basicValue:"10 boxes x 20 bags"},"Unit Price":{type:"FormattedNumber",basicValue:18,numberFormat:"$* #,##0.00"},Discontinued:{type:"Boolean",basicValue:!1}},cardLayout:{title:{property:"Product Name"},sections:[{layout:"List",properties:["Product ID"]},{layout:"List",title:"Quantity and price",collapsible:!0,collapsed:!1,properties:["Quantity Per Unit","Unit Price"]},{layout:"List",title:"Additional information",collapsed:!0,properties:["Discontinued"]}]}};return i.properties.Image={type:"WebImage",address:"https://upload.wikimedia.org/wikipedia/commons/thumb/0/04/Masala_Chai.JPG/320px-Masala_Chai.JPG"},i.cardLayout.mainImage={property:"Image"},i.properties.Category={type:"LinkedEntity",text:"Beverages",id:{entityId:"C1",domainId:"categories",serviceId:t,culture:r}},i.cardLayout.sections[0].properties.push("Category"),i.properties.Supplier={type:"LinkedEntity",text:"Exotic Liquids",id:{entityId:"S1",domainId:"suppliers",serviceId:t,culture:r}},i.cardLayout.sections[2].properties.push("Supplier"),i}(JSON.parse(o).entityId)}catch(e){throw console.error(e),i}}))}();
//# sourceMappingURL=functions.js.map