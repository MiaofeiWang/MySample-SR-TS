(function(){"use strict";CustomFunctions.associate("ADD",(function(e,t){return e+t})),CustomFunctions.associate("LOG",(function(e){return console.log(e),e})),CustomFunctions.associate("TESTREPEATINGPARAMETER",(async function(e,t){let o="";const r=new Excel.RequestContext;let i=r.workbook.worksheets.getActiveWorksheet();for(let n=0;n<e.length;n++){const a=e[n];if(0===a&&null!=t.parameterAddresses[n]){let e=i.getRange(t.parameterAddresses[n]).load("text");await r.sync(),""==e.text[0][0]?o+="[]":o+=e.text[0][0]}else o+=a}return o})),CustomFunctions.associate("RETURNAFTERASYNCLATENCY",(function(e,t){let o=1e3*(2*Math.random()-1)+e;return new Promise((e=>{setTimeout((()=>{e(Math.floor(o))}),o)}))})),CustomFunctions.associate("RETURNAFTERSLEEP",(function(e,t){let o=(new Date).getTime(),r=null;do{r=(new Date).getTime()}while(r-o<e);return e})),CustomFunctions.associate("GETSIMPLEENTITY",(function(){console.log("Start getSimpleEntity");let e=Math.floor(100*Math.random());return{type:Excel.CellValueType.entity,text:"Sample Entity "+e,properties:{randomNumber:{type:Excel.CellValueType.double,basicValue:e}}}})),CustomFunctions.associate("GETRICHERROR",(function(e){console.log("Start getRichError");let t=Excel.ErrorCellValueType.value;switch(e){case"timeout":t=Excel.ErrorCellValueType.timeout;break;case"blocked":t=Excel.ErrorCellValueType.blocked;break;case"busy":t=Excel.ErrorCellValueType.busy;break;case"calc":t=Excel.ErrorCellValueType.calc;break;case"div0":t=Excel.ErrorCellValueType.div0;break;case"external":t=Excel.ErrorCellValueType.external;break;default:t=Excel.ErrorCellValueType.value}return{type:Excel.CellValueType.error,errorType:t}}))})(),function(){const e="products",t=268436224,o="en-US";CustomFunctions.associate("GETPRODUCTBYID",(async function(r){return console.log(`Start getProductById: Fetching product with id ${r} ...`),{type:"LinkedEntity",text:"Chai",id:{entityId:r,domainId:e,serviceId:t,culture:o}}})),CustomFunctions.associate("PRODUCTLINKEDENTITYSERVICE",(async function(r){console.log(`Start productLinkedEntityService: Fetching linked entity with id ${r} ...`);const i=new CustomFunctions.Error(CustomFunctions.ErrorCode.notAvailable);console.log(`Fetching linked entity with id ${r} ...`);try{return function(r){const i={type:"LinkedEntity",text:"Chai",id:{entityId:r,domainId:e,serviceId:t,culture:o},properties:{"Product ID":{type:"String",basicValue:r.toString()},"Product Name":{type:"String",basicValue:"Chai"},"Quantity Per Unit":{type:"String",basicValue:"10 boxes x 20 bags"},"Unit Price":{type:"FormattedNumber",basicValue:18,numberFormat:"$* #,##0.00"},Discontinued:{type:"Boolean",basicValue:!1}},cardLayout:{title:{property:"Product Name"},sections:[{layout:"List",properties:["Product ID"]},{layout:"List",title:"Quantity and price",collapsible:!0,collapsed:!1,properties:["Quantity Per Unit","Unit Price"]},{layout:"List",title:"Additional information",collapsed:!0,properties:["Discontinued"]}]}};return i.properties.Image={type:"WebImage",address:"https://upload.wikimedia.org/wikipedia/commons/thumb/0/04/Masala_Chai.JPG/320px-Masala_Chai.JPG"},i.cardLayout.mainImage={property:"Image"},i.properties.Category={type:"LinkedEntity",text:"Beverages",id:{entityId:"C1",domainId:"categories",serviceId:t,culture:o}},i.cardLayout.sections[0].properties.push("Category"),i.properties.Supplier={type:"LinkedEntity",text:"Exotic Liquids",id:{entityId:"S1",domainId:"suppliers",serviceId:t,culture:o}},i.cardLayout.sections[2].properties.push("Supplier"),i}(JSON.parse(r).entityId)}catch(e){throw console.error(e),i}}))}();
//# sourceMappingURL=functions.js.map